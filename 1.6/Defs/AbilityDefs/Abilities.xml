<?xml version="1.0" encoding="utf-8" ?>
<Defs>

	<AbilityDef>
		<defName>APM_Absorb</defName>
		<label>absorb</label>
		<jobDef>CastAbilityOnThingMelee</jobDef>
		<description>PLACEHOLDER</description>
		<iconPath>UI/Absorb</iconPath>
		<cooldownTicksRange>90000</cooldownTicksRange><!-- 1.5 days -->
		<targetRequired>true</targetRequired>
		<hostile>false</hostile>
		<showCastingProgressBar>true</showCastingProgressBar>
		<displayGizmoWhileUndrafted>True</displayGizmoWhileUndrafted>
		<disableGizmoWhileUndrafted>False</disableGizmoWhileUndrafted>
		<verbProperties>
			<verbClass>Verb_CastAbilityTouch</verbClass>
			<warmupTime>1</warmupTime>
			<drawAimPie>false</drawAimPie>
			<range>-1</range>
			<targetParams>
				<canTargetCorpses>true</canTargetCorpses>
				<canTargetItems>true</canTargetItems>
				<mapObjectTargetsMustBeAutoAttackable>false</mapObjectTargetsMustBeAutoAttackable>
				<canTargetSelf>false</canTargetSelf>
				<canTargetPawns>false</canTargetPawns>
				<canTargetBuildings>false</canTargetBuildings>
				<thingCategory>None</thingCategory>
			</targetParams>
		</verbProperties>
		<comps>
			<li Class="ApexMechanoids.CompProperties_Absorb">
				<chemfuelPer1BodySizeOfCorpse>36</chemfuelPer1BodySizeOfCorpse>
				<chemfuelPer1Nutrition>10</chemfuelPer1Nutrition>
			</li>
		</comps>
	</AbilityDef>



	<AbilityDef>
		<defName>APM_SwitchToPowerPlantMode</defName>
		<label>Power Plant Mode</label>
		<description>...</description>
		<jobDef>CastAbilityOnThing</jobDef>
		<targetRequired>False</targetRequired>
		<canUseAoeToGetTargets>False</canUseAoeToGetTargets>
		<iconPath>UI/Commands/DropCarriedPawn</iconPath>
		<cooldownTicksRange>20000</cooldownTicksRange><!-- 8 hours -->
		<stunTargetWhileCasting>True</stunTargetWhileCasting>
		<showPsycastEffects>False</showPsycastEffects>
		<displayGizmoWhileUndrafted>True</displayGizmoWhileUndrafted>
		<disableGizmoWhileUndrafted>False</disableGizmoWhileUndrafted>
		<warmupStartSound>CombatCommand_Warmup</warmupStartSound>
		<casterMustBeCapableOfViolence>false</casterMustBeCapableOfViolence>
		<verbProperties>
			<verbClass>Verb_CastAbility</verbClass>
			<warmupTime>40</warmupTime>
			<range>0.48</range>
			<requireLineOfSight>False</requireLineOfSight>
			<targetParams>
				<canTargetSelf>true</canTargetSelf>
				<canTargetPawns>false</canTargetPawns>
				<canTargetBuildings>false</canTargetBuildings>
				<canTargetAnimals>false</canTargetAnimals>
				<canTargetHumans>false</canTargetHumans>
				<canTargetMechs>false</canTargetMechs>
			</targetParams>
		</verbProperties>
		<comps>
			<li Class="ApexMechanoids.CompProperties_ConvertToBuilding">
				<thingDef>APM_DynamoPoweredGenerator</thingDef>
			</li>
		</comps>
	</AbilityDef>
	
	<AbilityDef ParentName="PsycastBaseSkip">
		<defName>APM_CelerusBlink</defName>
		<label>blink</label>
		<description>WIP.</description>
		<level>4</level>
		<iconPath>UI/Blink</iconPath>
		<writeCombatLog>True</writeCombatLog>
		<casterMustBeCapableOfViolence>false</casterMustBeCapableOfViolence>
		<verbProperties>
			<warmupTime>0.25</warmupTime>
			<range>27.9</range>
			<targetParams>
				<canTargetSelf>True</canTargetSelf>
				<canTargetAnimals>True</canTargetAnimals>
				<canTargetItems>True</canTargetItems>
			</targetParams>
		</verbProperties>
		<comps>
			<li Class="CompProperties_AbilityTeleport">
				<compClass>CompAbilityEffect_Teleport</compClass>
				<destination>Selected</destination>
				<requiresLineOfSight>True</requiresLineOfSight>
				<range>17.9</range>
				<clamorType>Ability</clamorType>
				<clamorRadius>10</clamorRadius>
				<destClamorType>Ability</destClamorType>
				<destClamorRadius>10</destClamorRadius>
			</li>
		</comps>
	</AbilityDef>

	<AbilityDef>
		<defName>APM_SunRay</defName>
		<label>Sun Ray</label>
		<description>...</description>
		<iconPath>UI/Powerful</iconPath>
		<cooldownTicksRange>3500</cooldownTicksRange>
		<aiCanUse>true</aiCanUse>
		<sendMessageOnCooldownComplete>true</sendMessageOnCooldownComplete>
		<verbProperties>
			<verbClass>ApexMechanoids.Verb_ShootSunBeamAbility</verbClass>
			<hasStandardCommand>true</hasStandardCommand>
			<warmupTime>9.5</warmupTime>
			<range>34.9</range>
			<minRange>3.9</minRange>
			<targetParams>
				<canTargetLocations>true</canTargetLocations>
			</targetParams>
			<beamFullWidthRange>6.9</beamFullWidthRange>
			<burstShotCount>5</burstShotCount>
			<showBurstShotStats>false</showBurstShotStats>
			<beamWidth>6</beamWidth>
			<ticksBetweenBurstShots>14</ticksBetweenBurstShots>
			<beamDamageDef>APM_SunRay</beamDamageDef>
			<soundCastTail>GunTail_Medium</soundCastTail>
			<muzzleFlashScale>35</muzzleFlashScale>
			<soundCastBeam>BeamGraser_Shooting</soundCastBeam>
			<beamGroundFleckDef>APM_Fleck_SunRay_Burn</beamGroundFleckDef>
			<beamFleckChancePerTick>0.5</beamFleckChancePerTick>
			<beamMaxDeviation>1.5</beamMaxDeviation>
			<beamCurvature>0.6</beamCurvature>
			<beamMoteDef>APM_Mote_SunRay_Base</beamMoteDef>
			<beamEndEffecterDef>APM_Effecter_SunRay_End</beamEndEffecterDef>
			<beamChanceToStartFire>1</beamChanceToStartFire>
			<beamChanceToAttachFire>1</beamChanceToAttachFire>
			<beamFireSizeRange>1.0~1.5</beamFireSizeRange>
			<beamLineFleckDef>Fleck_BeamSpark</beamLineFleckDef>
			<beamStartOffset>0.8</beamStartOffset>
			<beamTargetsGround>true</beamTargetsGround>
			<beamCantHitWithinMinRange>true</beamCantHitWithinMinRange>
			<stopBurstWithoutLos>false</stopBurstWithoutLos>
			<ai_IsBuildingDestroyer>true</ai_IsBuildingDestroyer>
			<ai_ProjectileLaunchingIgnoresMeleeThreats>true</ai_ProjectileLaunchingIgnoresMeleeThreats>
			<aimingLineMote>APM_Mote_SunRay_Aim</aimingLineMote>
			<aimingChargeMote>APM_Mote_SunRay_Charge</aimingChargeMote>
			<aimingChargeMoteOffset>1.07</aimingChargeMoteOffset>
			<aimingLineMoteFixedLength>25.9</aimingLineMoteFixedLength>
			<aimingTargetMote>APM_Mote_SunRay_Target</aimingTargetMote>
			<soundAiming>HellsphereCannon_Aiming</soundAiming>
			<beamLineFleckChanceCurve>
				<points>
					<li>(0, 0)</li>
					<li>(0.65, 0.4)</li>
					<li>(1, 0.75)</li>
				</points>
			</beamLineFleckChanceCurve>
		</verbProperties>
	</AbilityDef>

	<!-- "targeting" for pinpoint mech -->
	<AbilityDef>
        <defName>ApexMechanoids_Ability_GiveAccuracyHediff</defName>
        <label>give accuracy hediff</label>
        <description>.</description>
        <iconPath>Things/Mote/SpeechSymbols/Speech</iconPath>
        <cooldownTicksRange>60</cooldownTicksRange>
        <hostile>true</hostile>
		<writeCombatLog>true</writeCombatLog>
		<aiCanUse>true</aiCanUse>
        <verbProperties>
            <verbClass>Verb_CastAbility</verbClass>
            <range>12.9</range>
            <warmupTime>0.5</warmupTime>
            <requireLineOfSight>False</requireLineOfSight>
            <soundCast>Pawn_Cat_Call</soundCast>
            <targetParams>
                <canTargetBuildings>false</canTargetBuildings>
            </targetParams>
        </verbProperties>
        <comps>
            <li Class="CompProperties_AbilityGiveHediff">
                <compClass>CompAbilityEffect_GiveHediff</compClass>
				<hediffDef>ApexMechanoids_TestAccuracyHediff</hediffDef>
            </li>
        </comps>
    </AbilityDef>
	
	<!-- "true sight" for pinpoint mech -->
	<AbilityDef>
        <defName>ApexMechanoids_Ability_RevealInvisible</defName>
        <label>reveal invisible</label>
        <description>.</description>
        <iconPath>Things/Mote/SpeechSymbols/Speech</iconPath>
        <cooldownTicksRange>60</cooldownTicksRange>
        <hostile>true</hostile>
		<writeCombatLog>true</writeCombatLog>
		<aiCanUse>true</aiCanUse>
		<canUseAoeToGetTargets>true</canUseAoeToGetTargets>
		<statBases>
			<Ability_EffectRadius>9.9</Ability_EffectRadius> <!-- this should make it possible to pick targets from AoE to push -->
		</statBases>
        <verbProperties>
            <verbClass>Verb_CastAbility</verbClass>
            <range>9.9</range>
            <warmupTime>0.5</warmupTime>
            <requireLineOfSight>False</requireLineOfSight>
            <soundCast>Pawn_Cat_Call</soundCast>
            <targetParams>
                <canTargetBuildings>false</canTargetBuildings>
            </targetParams>
        </verbProperties>
        <comps>
            <li Class="ApexMechanoids.CompProperties_AbilityRevealInvisibility"> <!-- should reveal invisible pawns -->
                <instant>false</instant>
            </li>
        </comps>
    </AbilityDef>
 
	<!-- "dashing" pawnFlyer with rope -->
	<ThingDef ParentName="PawnFlyerBase">
		<defName>ApexMechanoids_DashingPawn</defName>
		<label>dashing</label>
		  <thingClass>ApexMechanoids.PawnFlyerExtended</thingClass>
		  <drawGUIOverlay>true</drawGUIOverlay>
		<pawnFlyer>
		  <flightDurationMin>0.25</flightDurationMin>
		  <flightSpeed>20</flightSpeed>
		  <workerClass>PawnFlyerWorker</workerClass>
		  <heightFactor>0.05</heightFactor> <!-- low altitude -->
		  <progressCurve>
			<points>
			  <li>(0, 0)</li>
			  <li>(0.1, 0.15)</li>
			  <li>(1, 1)</li>
			</points>
		  </progressCurve>
		</pawnFlyer>
		<modExtensions>
			<li Class="ApexMechanoids.ModExt_PawnFlyerExt"> <!-- draw rope when dashing -->
				<rope>true</rope>
			</li>
		</modExtensions>
	</ThingDef>

	<!-- Siren Lure -->
	<AbilityDef>
        <defName>ApexMechanoids_Ability_SirenLure</defName>
        <label>siren lure</label>
        <description>.</description>
        <iconPath>Things/Mote/SpeechSymbols/Speech</iconPath>
        <cooldownTicksRange>60</cooldownTicksRange>
        <hostile>true</hostile>
		<writeCombatLog>true</writeCombatLog>
		<aiCanUse>true</aiCanUse>
        <verbProperties>
            <verbClass>Verb_CastAbility</verbClass>
            <range>29.9</range>
            <warmupTime>0.5</warmupTime>
            <requireLineOfSight>False</requireLineOfSight>
            <soundCast>Pawn_Cat_Call</soundCast>
            <targetParams>
                <canTargetSelf>False</canTargetSelf>
                <canTargetBuildings>False</canTargetBuildings>
				<canTargetLocations>False</canTargetLocations>
				<canTargetAnimals>False</canTargetAnimals>
            </targetParams>
        </verbProperties>
		<statBases>
			<Ability_Duration>10</Ability_Duration>
			<Ability_EffectRadius>0.9</Ability_EffectRadius>
		</statBases>
        <comps>
            <li Class="CompProperties_AbilityForceJob">
				<compClass>CompAbilityEffect_ForceJob</compClass>
                <jobDef>GotoMindControlled</jobDef>
				<destination>Caster</destination>
				<range>0.9</range>
            </li>
        </comps>
    </AbilityDef>

</Defs>